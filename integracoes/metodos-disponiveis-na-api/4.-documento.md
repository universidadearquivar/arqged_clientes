# ◼️ 4. Documento

## 4.1 PUT/api/Documento/Put

O objetivo deste método é permitir que o usuário **altere os dados de um documento**.

A alteração é feita apenas nos dados dos campos indexadores (campos customizados e/ou lista).

### Entrada

Neste serviço o usuário deve informar o id da unidade, id do cliente, id da árvore organizacional,  id do documento e o JSON com os metadados que deseja alterar.

• idUnidade

• idCliente

• idArvoreOrganizacional

• idDocumento

• JSON com os dados do documento informado que serão alterados.

{% hint style="info" %}
<mark style="color:blue;">O usuário pode informar um ou mais campos que serão alterados.</mark>
{% endhint %}

#### Request boby

```json
[
    {
        "valor": "string",//novo valor para o campo que está sendo alterado
        "campo": "string",//nome do campo que está sendo alterado
        "nomeLista": "string"//nome da lista, se o campo pertencer a uma lista
    }
]
```

### Validações

O sistema valida:

• A permissão do usuário autenticado.

• Se o Id do documento existe e se pertence ao cliente informado.

• Se o Id do documento está vinculado ao id da árvore informado.

• Se os campos indexadores pertencem a árvore organizacional informada.

• Para indexadores de lista, o sistema valida se a árvore possui a configuração da lista.

#### 1. Para Lista de Autocomplete ou Consolidação (Permitir a inclusão durante a alteração)

O sistema permite a inclusão de novos dados na lista. Os campos chaves, bem como os campos de importação obrigatória, devem ser informados.&#x20;

> * Ao informar um campo chave que não existe na lista, o sistema inclui um novo item e associa ao documento que está sendo alterado.
> * Ao informar um campo chave que existe na lista, o sistema associa o item na lista e ao documento que está sendo alterado.

#### 2. Para lista de Consolidação (Não Permitir a inclusão durante a alteração)

O sistema não permite a inclusão de novos dados na lista. Ou seja, deve-se realizar a importação da lista antes de iniciar o processo de cadastro de documentos.

> * Ao informar um campo chave que não existe na lista, o sistema não permite alterar o documento.
> * Ao informar um campo chave que existe na lista, o sistema associa o item na lista e ao documento que está sendo alterado.

### Saída/Retorno

O sistema retorna a mensagem de registro alterado com sucesso.

Code: 200 - OK

#### Response

```json
"Registro alterado com sucesso."
```

***

## 4.2 POST/api/Documento/Post

O objetivo deste método é permitir que o usuário **cadastre** documentos em determinado nível de árvore. O usuário pode incluir no documento um ou mais arquivos.

### Entrada

Neste serviço o usuário deve informar o id da unidade, o id do cliente, o id da árvore organizacional e o JSON com os dados do documento.

• idUnidade

• idCliente

• idArvoreOrganizacional

• JSON com os dados do documento.

> * Quando documento eletrônico, informar o valor null no parâmetro codigoCaixa.
> * Quando documento Guarda Interna ou Guarda Terceirizada, informar o código da caixa que o documento será armazenado no parâmetro codigoCaixa.
> * O usuário deve informar os campos customizados e/ou de listas que estão configurados no idArvoreOrganizacional informado.
> * O documento que será criado pode ou não ter um ou mais arquivos anexados.

#### Request body

```json
{
    "codigoCaixa": null,//null ou código da caixa
    "valoresCampos": [
        {
            "nomeLista": "string",//nome da lista se for campo de lista.
            "label": "string",//nome do campo
            "valorCampo": "string",//Valor do campo        
        },
        {
            "nomeLista": "string",
            "label": " string ",
            "valorCampo": " string "
        },
        {
            "nomeLista": "string",
            "label": " string ",
            "valorCampo": " string "
        }
    ],
    "arquivos": [//Arquivos que serão anexados ao documento criado
        {
            "arquivo": "bytes",//bytes do arquivo
            "contentType": "application/extensão",[//tipo do arquivo
            "extensao": "string",[//extensão do arquivo
            "nomeAmigavel": "string"[//nome do arquivo
        },
        {
            "arquivo": "bytes",
            "contentType": "application/extensão",
            "extensao": "string",
            "nomeAmigavel": "string"
        }
    ]
}
```

### Validações

O sistema valida:

• A permissão do usuário autenticado.

• O código da caixa informado.

• Se o Id da arvore organizacional existe e se pertence ao cliente informado.

• Os campos indexadores informados.

### Saída/Retorno

O sistema retorna o id e o código do documento cadastrado.

Code: 201 - Created

#### Response

```json
[
    "Registro adicionado com sucesso.",
    "IdDocumento: 4298ca74-82ac-4fc2-95b3-33c176ff4323",
    "CodigoDocumento: 106609146"
]
```

***
